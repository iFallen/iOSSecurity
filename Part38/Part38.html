<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.10 (454267)"/><meta name="author" content="JuanFelix"/><meta name="created" content="2017-03-15 05:18:42 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2017-03-15 06:06:58 +0000"/><title>Part38</title></head><body><div><p style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><b style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: 700; font-size: 14px; vertical-align: baseline;">This is a guest lecture by <a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="http://etolstoy.ru">Egor Tolstoy</a>. Egor is a full-time iOS developer working at Rambler&amp;Co and living with his lovely wife in Moscow, Russia. In his spare time he investigate iOS applications for different vulnerabilities and blogs about my research.</b></p><div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="http://parse.com/">Parse</a> is a wonderful BaaS which helps with setting up backend infrastructure for your mobile application as fast as possible. Maybe just because of this simplicity many developers forget about a number of new security issues and vulnerabilities.
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img src="Part38.resources/E3726354-6CCC-4A28-8A24-B83E8EE71B0B.png" height="495" width="816"/></div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">For those who don’t know what this service is, let’s make a brief introduction. Parse provides a lot of useful capabilities to mobile developer: cloud data storage, push notifications, usage statistics and crash logs gathering, code hosting, background jobs and a many other things. Within the boundaries of thes research we are interested in the cloud data storage, named <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">Cloud Core</i>.
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">All the data in Cloud Core is stored in so called custom classes (ordinary database tables).
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img src="Part38.resources/ADBAAA9A-39B3-43CC-AF7D-4D9A3BFE4DB1.png" height="412" width="1024"/></div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">You can set a number of different client permissions for each of these classes: <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">GET, FIND, UPDATE, CREATE, DELETE</i> and <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">ADD FIELDS</i>. All of them are <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">Public</i> by default. Of course, most of the developers forget about the need of setting client access permissions once they configure their tables.
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img src="Part38.resources/5E190C2C-C27C-45B8-8EBF-8F06F8893E96.png" height="535" width="403"/></div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">I’ve closely faced Parse during one of my work projects and spent a lot of time configuring ACLs properly – so I became interested in how other developers maintain their Parse accounts. I’ve found the object for my little research right on <a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="https://parse.com/customers">parse.com/customers</a>. It was <a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="http://cubefreeapp.com/">Cubefree</a> – a service for locating cowering spaces.
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; padding: 0px 45px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 13px; vertical-align: baseline; background-color: rgb(51, 66, 75); color: rgb(255, 255, 255); text-align: left; text-transform: uppercase; background-position: initial initial; background-repeat: initial initial;">INFOSEC RESOURCES IN-LINE – EH</span></div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">A pair of keys is used for connecting to Parse account from a mobile application: <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">Application ID</i> and <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">Client Key</i>. We’ve got to find out these strings in order to manipulate the data in Cloud Core. Let’s decrypt the application binary with the help of <a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="https://github.com/dmayer/idb">idb</a> – an awesome iOS pentesting utility. While the decryption process is going on, we can check <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">NSUserDefaults</i> – a rather common place for storing such kind of data (only for reckless developers, of course).
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img src="Part38.resources/D3352F15-56F6-4A06-8E19-D79159C2262E.png" height="486" width="879"/></div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">As you can see, nothing criminal was found – no signs of confidential data. Let’s get back to our decrypted application binary and feed it to <a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="http://www.hopperapp.com/">Hopper</a> – a well known disassembler, specialized in reverse-engineering Objective-C applications. Our quest for Parse keys will begin inÂ <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">application:didFinishLaunchingWithOptions method</i> of <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">App Delegate.</i> One of the noteworthy Hopper features is the ability to represent any procedure in pseudocode form, which flattens the reversed code understanding curve.
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img src="Part38.resources/14DA7D3C-1EDE-4856-9362-A36C0B7FFDFC.png" height="602" width="667"/></div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">As expected, the connection to Parse is initiated right here. Now we’ll analyse the structure of Parse data and its client permissions.
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">The next step is identification of Parse tables names. Actually, we can see them on the same screenshot as client keys – there is a plenty of <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">registerSubclass</i> method calls. These classes are children of the root <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">PFObject</i> class. Each of them has a method <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">parseClassName, </i>which returns a corresponding Parse table name.
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img src="Part38.resources/AFCA3C48-6BAF-4A77-AF9B-BF25D1C2BBFC.png" height="87" width="582"/></div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Let’s inspect the structure of these tables:
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="https://gist.github.com/igrekde/cb8e2c12408715c9f739#file-parse-security-1">https://gist.github.com/igrekde/cb8e2c12408715c9f739#file-parse-security-1</a></div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">The knowledge of classes organization, however, is not enough. We should try to inspect access permissions for all the Parse classes to determine how we can influence the application behaviour. It’s quite simple – all we have to do is to make a couple of queries to Parse and analyse their results. I’ve wrote a small utility – <a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="https://github.com/igrekde/ParseRevealer">Parse Revealer</a>, which simplifies these routine actions and automatically determines the access permissions for all known classes.
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img src="Part38.resources/A810FA82-BD62-43AC-98BB-7898776A9447.png" height="694" width="592"/></div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">We can create a table using all the derived data:
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img src="Part38.resources/D70A53E7-798C-432F-AE84-3EC2E550CC97.png" height="761" width="738"/></div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">As we can see from the list of permissions, the developers tried to implement a security policy, but it wasn’t enough. Let’s show what we can achieve by manipulating the <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">ChatMessage</i> class.
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">The most obvious vulnerability is that the attacker is able to modify the text of any message in any chatroom. After the execution of this code block the reasonable statement turns into a nonsense:
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="https://gist.github.com/igrekde/cb8e2c12408715c9f739#file-parse-security-2">https://gist.github.com/igrekde/cb8e2c12408715c9f739#file-parse-security-2</a></div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><img src="Part38.resources/4E6DBBD3-44AA-48A2-AD32-4B4769E77343.png" height="907" width="1024"/></div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">We can also post new messages to any chat by providing a new <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">PFObject</i> with a correct chatId. But we are noble pentesters, so let’s pay attention to the fact that we aren’t able to delete any message due to developers paranoia :).
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">A much more serious vulnerability consists in incorrect data mapping algorithm. When a <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">ChatMessage</i> object doesn’t have anything in the sender field, the Cubefree application crashes. So, it’s possible to loop through all the chatrooms, post an invalid <i style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: italic; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">ChatMessage</i> – and the application will always crash when somebody opens the chat screen. It’s fraught with bad App Store ratings, users outflow and a complete project failure.
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">There are same vulnerabilities in other classes – but they are not within the scope of current investigation.
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">As for security of your own applications – everything is quite transparent, just follow these simple rules:
</div><ul style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; list-style: disc; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><li style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">Always configure client permissions for all of your Parse classes.</li><li style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">Make use of user-based ACLs – it’s a great Parse feature.</li><li style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">If a client should be able to modify only one property of your class, think of encapsulating this field in the separate class. By doing it you will circumvent the possibility of illegal changes in your objects.</li><li style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">Don’t rely on Parse – always do a proper validity check of the data it returns you.</li><li style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">Remember that, theoretically, applicationID and clientKey can be found by any attacker, so you should build your application security grounding on this knowledge.</li><li style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">The previous advice doesn’t cancel the necessarily of obfuscating strings in code :)</li><li style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;">Use Cloud Code in more complex situations.</li></ul><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">If you recognise some of your applications in this research, don’t blame Parse – it’s the amazing service, which minimize backend developing costs. All of the examined vulnerabilities lie heavy on the developers conscience.
</div><div style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">Further reading:
</div></div><ul style="box-sizing: border-box; padding: 0px; border: 0px; font-family: Montserrat, sans-serif; font-style: normal; font-variant-caps: normal; font-weight: normal; font-size: 14px; vertical-align: baseline; list-style: disc; color: rgb(71, 71, 71); letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><li style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;"><a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="https://www.parse.com/docs">Parse Documentation</a></li><li style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;"><a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="http://blog.parse.com/2014/06/30/parse-security-i-are-you-the-key-master">A small series of articles about Parse security</a></li><li style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;"><a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="https://github.com/igrekde/ParseRevealer">Parse Revealer</a></li><li style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;"><a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="http://highaltitudehacks.com/2014/01/17/ios-application-security-part-28-patching-ios-application-with-hopper/">iOS Application Security Part 28 – Patching iOS Application With Hopper</a></li><li style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline;"><a style="box-sizing: border-box; padding: 0px; border: 0px; font-family: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-size: 14px; vertical-align: baseline; color: rgb(41, 122, 160);" href="https://www.mikeash.com/pyblog/friday-qa-2012-01-06-the-hopper-disassembler.html">The Hopper Disassembler by Mike Ash</a></li></ul><br/></div><div><br/></div></body></html>